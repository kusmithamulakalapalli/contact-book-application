<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Contact Hub 2.0 - Advanced Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --accent-gradient: linear-gradient(45deg, #ff6b9d, #4facfe);
      --success: #27ae60;
      --warning: #f39c12;
      --danger: #e74c3c;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', -apple-system, sans-serif;
      background: var(--primary-gradient);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Modern Header */
    header {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(20px);
      color: white;
      padding: 20px;
      text-align: center;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    header h1 {
      font-size: clamp(2rem, 5vw, 3rem);
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
    }

    .container {
      max-width: 1200px;
      margin: 30px auto;
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.3);
    }

    /* Modern Form with Glassmorphism */
    .form-section {
      background: rgba(255,255,255,0.6);
      padding: 25px;
      border-radius: 20px;
      margin-bottom: 30px;
      backdrop-filter: blur(10px);
    }
    .form-row {
      display: grid;
      grid-template-columns: 2fr 1.5fr 1.5fr;
      gap: 15px;
      margin-bottom: 20px;
    }
    input {
      padding: 15px;
      border: 2px solid rgba(102,126,234,0.3);
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: rgba(255,255,255,0.8);
    }
    input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102,126,234,0.2);
      transform: translateY(-2px);
    }

    .form-buttons {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }
    button {
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    #addBtn { background: var(--success); color: white; }
    #updateBtn { background: #3498db; color: white; display: none; }
    #cancelEditBtn { background: #95a5a6; color: white; display: none; }

    /* Filter Section */
    .filter-section {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      align-items: center;
      flex-wrap: wrap;
    }
    #searchInput {
      flex: 1;
      min-width: 300px;
    }
    #favoritesOnly, #sortAlpha {
      background: var(--warning);
      color: white;
      padding: 15px 20px;
    }

    /* Modern Table */
    .contacts-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 10px;
      margin-top: 20px;
    }
    .contacts-table thead {
      background: rgba(102,126,234,0.1);
    }
    th {
      padding: 20px 15px;
      text-align: left;
      font-weight: 600;
      color: #2c3e50;
      font-size: 15px;
    }
    tr {
      background: rgba(255,255,255,0.7);
      transition: all 0.3s ease;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    tr:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    .favorite-row {
      background: linear-gradient(90deg, #fff3cd, #ffeaa7) !important;
      border-left: 5px solid #f39c12;
    }
    td {
      padding: 20px 15px;
      vertical-align: middle;
    }

    /* Action Buttons Grid */
    .actions {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
    }
    .action-btn {
      padding: 10px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      color: white;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    .call { background: #27ae60; }
    .sms { background: #e74c3c; }
    .edit { background: #3498db; }
    .delete { background: #95a5a6; }
    .loc { background: #f39c12; }
    .favorite { background: #f1c40f; color: #333; }

    /* Status Display */
    #locationStatus {
      margin-top: 25px;
      padding: 20px;
      border-radius: 12px;
      background: rgba(52,152,219,0.1);
      border-left: 5px solid #3498db;
      font-size: 15px;
      display: none;
    }

    /* Animations */
    @keyframes slideInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .container > * { animation: slideInUp 0.6s ease forwards; }

    @media (max-width: 768px) {
      .form-row { grid-template-columns: 1fr; }
      .filter-section { flex-direction: column; }
      .actions { grid-template-columns: repeat(2, 1fr); }
      .contacts-table { font-size: 14px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>â­ Contact Hub 2.0 Pro</h1>
    <p>Advanced Contact Management with AI Sorting & Real-time Tracking</p>
  </header>

  <div class="container">
    <!-- Modern Add/Edit Form -->
    <div class="form-section">
      <h2>â• Add New Contact</h2>
      <div class="form-row">
        <input type="text" id="name" placeholder="ğŸ‘¤ Full Name *" required />
        <input type="tel" id="phone" placeholder="ğŸ“± Phone Number *" inputmode="tel" required />
        <input type="email" id="email" placeholder="âœ‰ï¸ Email (optional)" />
      </div>
      <div class="form-buttons">
        <button id="addBtn">â• Add Contact</button>
        <button id="updateBtn">âœï¸ Update Contact</button>
        <button id="cancelEditBtn">âŒ Cancel</button>
      </div>
    </div>

    <!-- Advanced Filters -->
    <div class="filter-section">
      <h3>ğŸ“‹ Contacts ({contactsCount})</h3>
      <input type="text" id="searchInput" placeholder="ğŸ” Search name or phone..." />
      <button id="favoritesOnly">â­ Favorites Only</button>
      <button id="sortAlpha">ğŸ”¤ Alphabetical</button>
    </div>

    <!-- Modern Table -->
    <table class="contacts-table">
      <thead>
        <tr>
          <th>â­</th>
          <th>ğŸ‘¤ Name</th>
          <th>ğŸ“± Phone</th>
          <th>âœ‰ï¸ Email</th>
          <th>âš¡ Actions</th>
        </tr>
      </thead>
      <tbody id="contactBody"></tbody>
    </table>

    <!-- Location Status -->
    <div id="locationStatus"></div>
  </div>

  <script>
    // Modern State Management
    class ContactHub {
      constructor() {
        this.contacts = JSON.parse(localStorage.getItem('contactHubPro_contacts')) || [];
        this.editIndex = null;
        this.showFavoritesOnly = false;
        this.isAlphabetical = true;
        this.init();
      }

      init() {
        this.bindEvents();
        this.render();
        this.updateCounters();
      }

      bindEvents() {
        document.getElementById('addBtn').onclick = () => this.addContact();
        document.getElementById('updateBtn').onclick = () => this.updateContact();
        document.getElementById('cancelEditBtn').onclick = () => this.cancelEdit();
        document.getElementById('searchInput').oninput = () => this.render();
        document.getElementById('favoritesOnly').onclick = () => this.toggleFavorites();
        document.getElementById('sortAlpha').onclick = () => this.toggleSort();
      }

      // Phone validation with modern regex
      validatePhone(phone) {
        return /^[+]?[1-9][d]{0,15}$/.test(phone.replace(/[s-()]/g, ''));
      }

      addContact() {
        const name = document.getElementById('name').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const email = document.getElementById('email').value.trim();

        if (!name || !phone) return alert('âŒ Name & Phone required!');
        if (!this.validatePhone(phone)) return alert('âŒ Invalid phone format!');

        this.contacts.push({ name, phone, email, isFavorite: false });
        this.save();
        this.clearForm();
        this.render();
      }

      updateContact() {
        if (this.editIndex === null) return;
        const name = document.getElementById('name').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const email = document.getElementById('email').value.trim();

        if (!name || !phone || !this.validatePhone(phone)) {
          return alert('âŒ Valid name & phone required!');
        }

        this.contacts[this.editIndex] = { name, phone, email, isFavorite: this.contacts[this.editIndex].isFavorite };
        this.save();
        this.clearForm();
        this.render();
      }

      editContact(index) {
        const contact = this.contacts[index];
        document.getElementById('name').value = contact.name;
        document.getElementById('phone').value = contact.phone;
        document.getElementById('email').value = contact.email || '';
        this.editIndex = index;

        document.getElementById('addBtn').style.display = 'none';
        document.getElementById('updateBtn').style.display = 'inline-block';
        document.getElementById('cancelEditBtn').style.display = 'inline-block';
      }

      deleteContact(index) {
        if (confirm(`ğŸ—‘ï¸ Delete ${this.contacts[index].name}?`)) {
          this.contacts.splice(index, 1);
          this.save();
          this.render();
        }
      }

      toggleFavorite(index) {
        this.contacts[index].isFavorite = !this.contacts[index].isFavorite;
        this.save();
        this.render();
      }

      toggleFavorites() {
        this.showFavoritesOnly = !this.showFavoritesOnly;
        document.getElementById('favoritesOnly').textContent = this.showFavoritesOnly ? 'ğŸ“± All Contacts' : 'â­ Favorites Only';
        this.render();
      }

      toggleSort() {
        this.isAlphabetical = !this.isAlphabetical;
        document.getElementById('sortAlpha').textContent = this.isAlphabetical ? 'ğŸ”¢ Default' : 'ğŸ”¤ Alphabetical';
        this.render();
      }

      getFilteredContacts() {
        let filtered = [...this.contacts];
        
        // Alphabetical sorting (NEW)
        if (this.isAlphabetical) {
          filtered.sort((a, b) => a.name.localeCompare(b.name, undefined, { sensitivity: 'base' }));
        }

        // Search filter
        const query = document.getElementById('searchInput').value.toLowerCase();
        filtered = filtered.filter(c => 
          c.name.toLowerCase().includes(query) || 
          c.phone.includes(query)
        );

        // Favorites filter
        if (this.showFavoritesOnly) {
          filtered = filtered.filter(c => c.isFavorite);
        }

        return filtered;
      }

      render() {
        const filtered = this.getFilteredContacts();
        const tbody = document.getElementById('contactBody');
        tbody.innerHTML = '';

        filtered.forEach((contact, index) => {
          const globalIndex = this.contacts.indexOf(contact);
          const row = document.createElement('tr');
          if (contact.isFavorite) row.classList.add('favorite-row');

          row.innerHTML = `
            <td>
              <button class="action-btn favorite" onclick="hub.toggleFavorite(${globalIndex})">
                ${contact.isFavorite ? 'â­' : 'â˜†'}
              </button>
            </td>
            <td><strong>${contact.name}</strong></td>
            <td>${contact.phone}</td>
            <td>${contact.email || '-'}</td>
            <td>
              <div class="actions">
                <button class="action-btn call" onclick="window.callContact('${contact.phone}')">ğŸ“</button>
                <button class="action-btn sms" onclick="window.smsContact('${contact.phone}')">ğŸ’¬</button>
                <button class="action-btn loc" onclick="window.trackLocation('${contact.name}')">ğŸ“</button>
                <button class="action-btn edit" onclick="hub.editContact(${globalIndex})">âœï¸</button>
                <button class="action-btn delete" onclick="hub.deleteContact(${globalIndex})">ğŸ—‘ï¸</button>
              </div>
            </td>
          `;
          tbody.appendChild(row);
        });

        this.updateCounters();
      }

      updateCounters() {
        const countEl = document.querySelector('h3');
        countEl.textContent = `ğŸ“‹ Contacts (${this.contacts.length})`;
      }

      clearForm() {
        document.getElementById('name').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('email').value = '';
        this.editIndex = null;
        document.getElementById('addBtn').style.display = 'inline-block';
        document.getElementById('updateBtn').style.display = 'none';
        document.getElementById('cancelEditBtn').style.display = 'none';
      }

      cancelEdit() {
        this.clearForm();
      }

      save() {
        localStorage.setItem('contactHubPro_contacts', JSON.stringify(this.contacts));
      }
    }

    // Global functions for onclick handlers
    window.callContact = (phone) => window.location.href = `tel:${phone}`;
    window.smsContact = (phone) => window.location.href = `sms:${phone}`;
    window.trackLocation = (name) => {
      const status = document.getElementById('locationStatus');
      status.style.display = 'block';
      status.innerHTML = `ğŸ“ Tracking <strong>${name}</strong>...`;

      if (!navigator.geolocation) {
        status.innerHTML = 'âŒ Geolocation not supported';
        return;
      }

      navigator.geolocation.getCurrentPosition(
        pos => {
          const { latitude, longitude } = pos.coords;
          status.innerHTML = `
            âœ… <strong>${name}</strong> Location Found!<br>
            ğŸ“ Lat: ${latitude.toFixed(6)} | Lng: ${longitude.toFixed(6)}<br>
            <a href="https://maps.google.com/?q=${latitude},${longitude}" target="_blank" 
               style="color: #3498db; text-decoration: none; font-weight: 600;">
              ğŸ—ºï¸ Open in Google Maps
            </a>
          `;
        },
        err => status.innerHTML = `âŒ Location error: ${err.message}`
      );
    };

    // Initialize app
    const hub = new ContactHub();
    window.hub = hub;
  </script>
</body>
</html>